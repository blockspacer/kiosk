cmake_minimum_required(VERSION 3.4)
project(panelberry CXX)

set(CMAKE_MODULE_PATH
  ${PROJECT_SOURCE_DIR}/cmake
  ${CMAKE_MODULE_PATH})

set(TOPLEVEL_VERSION_MAJOR 0)
set(TOPLEVEL_VERSION_MINOR 1)
set(TOPLEVEL_VERSION_PATCH 0)
set(TOPLEVEL_VERSION_BUILD 1)
set(TOPLEVEL_VERSION_STABILITY "-alpha")
set(TOPLEVEL_VERSION ${TOPLEVEL_VERSION_MAJOR}.${TOPLEVEL_VERSION_MINOR}.${TOPLEVEL_VERSION_PATCH})

CONFIGURE_FILE(${PROJECT_SOURCE_DIR}/project_version.h.in ${PROJECT_BINARY_DIR}/project_version.h)

include_directories(${PROJECT_SOURCE_DIR})
include_directories(${PROJECT_BINARY_DIR})

add_subdirectory(libs)
add_subdirectory(apps/pphue pphue)
add_subdirectory(apps/panel panel)

set(CPACK_PACKAGE_VENDOR "midnightBITS")
set(CPACK_PACKAGE_CONTACT "panelberry-maintainers@midnightbits.com")
set(CPACK_PACKAGE_DESCRIPTION_SUMMARY "Control panel for IoT devices on RPi")
set(CPACK_PACKAGE_VERSION_MAJOR "${TOPLEVEL_VERSION_MAJOR}")
set(CPACK_PACKAGE_VERSION_MINOR "${TOPLEVEL_VERSION_MINOR}")
set(CPACK_PACKAGE_VERSION_PATCH "${TOPLEVEL_VERSION_PATCH}")
set(CPACK_PACKAGE_VERSION "${TOPLEVEL_VERSION}${TOPLEVEL_VERSION_STABILITY}+${TOPLEVEL_VERSION_BUILD}")
set(CPACK_PACKAGE_INSTALL_DIRECTORY "${PROJECT_NAME} ${TOPLEVEL_VERSION_MAJOR}.${TOPLEVEL_VERSION_MINOR}")
include(CPack)
